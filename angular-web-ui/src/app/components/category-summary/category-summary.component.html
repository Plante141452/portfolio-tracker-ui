<mat-accordion *ngIf="category">
    <div *ngIf="category.categories && categoryMetrics">
        <mat-expansion-panel *ngFor='let nestedCategory of category.categories'>
            <mat-expansion-panel-header *ngIf="categoryMetrics[nestedCategory.name]">
                <div class="category-info-container">
                    <div class="category-name-label">
                        {{nestedCategory.name}}
                    </div>
                    <div class="category-percent-label">
                        {{categoryMetrics[nestedCategory.name].percentOfCategory.toFixed(2)}}%
                    </div>
                    <div
                        [class]="'category-change-label ' + (categoryMetrics[nestedCategory.name].percentChange > 0 ? 'green' : 'red')">
                        {{categoryMetrics[nestedCategory.name].percentChange > 0 ? '+' : '' }}{{categoryMetrics[nestedCategory.name].percentChange.toFixed(2)}}%
                    </div>
                </div>
            </mat-expansion-panel-header>

            <app-category-summary [category]="nestedCategory" [quotes]="quotes" [stockHistory]="stockHistory"
                [edit]="edit" [mode]="mode">
            </app-category-summary>

        </mat-expansion-panel>
    </div>

    <div *ngIf="stockData" style="display: flex;flex-direction: column;">
        <stock-item [stockData]="stock" *ngFor="let stock of categoryStockData">
        </stock-item>
    </div>
</mat-accordion>